# Proje Bilgileri - AC Charger

## Künye

**Dosya Adı:** project_info_20251208_145614.md  
**Yaratılma Tarihi:** 2025-12-08 14:56:16  
**Son Değiştirilme Tarihi:** 2025-12-08 17:19:00  
**Version:** 1.3.7  
**Özet:** AC charger projesi için proje bilgileri, önemli notlar, dersler ve edinilen bilgilerin tutulduğu dokümantasyon dosyası.

---

## Proje Genel Bilgileri

### Proje Amacı
AC charger geliştirme projesi.

### Donanım Altyapısı
- **Raspberry Pi:** SSH ile bağlı, tam yetkilere sahip
- **ESP32:** USB üzerinden Raspberry Pi'ye bağlı

### Versiyon Kontrolü ve Repository (2025-12-08 15:06:06)
- **GitHub Repository:** https://github.com/CaiserSz/orge1.git
- GitHub repository ile sync gidilmesi ve local'in commit/push edilmesi için özen gösterilecektir
- Git ve GitHub sürekli aktif olarak commit edilecektir

### Git Kurulumu ve İlk Push (2025-12-08 15:15:35)
- Git repository başarıyla başlatıldı ve ilk commit yapıldı
- Raspberry Pi'de SSH key oluşturuldu (ED25519, fingerprint: SHA256:XrA2Pz/9I8jHWvJV0h7IXHbNqXCl5ahlax1PNmpDz6Q)
- SSH key GitHub'a eklendi ve bağlantı başarıyla test edildi
- İlk push başarıyla tamamlandı (commit: 57be7e3)
- Branch: main, Remote: git@github.com:CaiserSz/orge1.git (SSH)

### Ngrok Yapılandırması ve Dışarıdan Erişim (2025-12-08 17:13:10)

#### Genel Bilgiler
- **Ngrok Versiyonu:** v3.34.0
- **Yapılandırma Dosyası:** `/home/basar/charger/ngrok.yml`
- **Servis Durumu:** ✅ Sistem servisi olarak kurulu ve aktif
- **Otomatik Başlatma:** ✅ Sistem açılışında otomatik başlatma aktif (enabled)

#### Yapılandırma Detayları

**HTTP/HTTPS Tunnel (API, Web ve CSMS):**
- **Public URL:** `https://lixhium.ngrok.app`
- **Local Address:** `http://localhost:8000`
- **Domain:** `lixhium.ngrok.app` (Reserved Domain)
- **Domain ID:** `rd_2xYXpwyNNgABarNketjeXYIKzQ4`
- **Desteklenen Protokoller:**
  - HTTP/HTTPS (REST API, Web UI)
  - WebSocket (OCPP/CSMS bağlantıları için)
- **Kullanım Alanları:**
  - REST API endpoint'leri
  - Web arayüzü
  - OCPP WebSocket bağlantıları (CSMS ile haberleşme)
- **Durum:** ✅ Aktif ve dışarıdan erişilebilir

**SSH Tunnel:**
- **Public URL:** Dinamik adres (servis yeniden başlatıldığında değişebilir)
- **Local Address:** `localhost:22` (SSH servisi)
- **Durum:** ✅ Aktif ve dışarıdan erişilebilir
- **Kullanım:** Dışarıdan SSH erişimi için

#### Kimlik Doğrulama
- **AUTHTOKEN:** `ngrok.yml` dosyasında tanımlı
- **NGROK_API_KEY:** `.env` dosyasında tanımlı (`32AHSFuAnr3dEqbISzXQj8LT2bT_89vhksjQHgjV3Z644eDk3`)
- **API Bağlantısı:** ✅ Ngrok API'ye başarıyla bağlanıldı

#### Servis Yönetimi Komutları
```bash
# Servis durumunu kontrol etme
sudo systemctl status ngrok

# Servisi başlatma
sudo systemctl start ngrok

# Servisi durdurma
sudo systemctl stop ngrok

# Servisi yeniden başlatma
sudo systemctl restart ngrok

# Servis loglarını görüntüleme
sudo journalctl -u ngrok -f
```

#### Ngrok Web Arayüzü
- **URL:** `http://localhost:4040`
- **Erişim:** Sadece localhost'tan erişilebilir
- **API Endpoint:** `http://localhost:4040/api/tunnels` (tunnel bilgilerini JSON formatında döner)

#### Dışarıdan Erişim

**1. API ve Web Erişimi:**
- **URL:** `https://lixhium.ngrok.app`
- **Hedef:** RPi'deki port 8000
- **Kullanım:** 
  - REST API endpoint'leri
  - Web arayüzü
  - HTTP/HTTPS servisleri

**2. CSMS (OCPP) WebSocket Bağlantısı:**
- **WebSocket URL:** `wss://lixhium.ngrok.app` (HTTP tunnel üzerinden WebSocket upgrade)
- **Hedef:** RPi'deki port 8000 (OCPP WebSocket servisi)
- **Kullanım:** 
  - OCPP 1.6J WebSocket bağlantıları
  - OCPP 2.0.1 WebSocket bağlantıları
  - CSMS (Central System Management System) ile haberleşme
- **Not:** HTTP tunnel WebSocket'i destekler, ayrı bir tunnel gerekmez

**3. SSH Erişimi:**
- **Adres:** Dinamik TCP adresi (servis yeniden başlatıldığında değişebilir)
- **Hedef:** RPi SSH servisi (port 22)
- **Kullanım:** Dışarıdan SSH bağlantısı
- **Güncel SSH Adresini Öğrenme:**
  ```bash
  curl -s http://localhost:4040/api/tunnels | python3 -c "import sys, json; data=json.load(sys.stdin); tunnels=[t for t in data.get('tunnels', []) if t.get('name')=='ssh']; url=tunnels[0]['public_url'] if tunnels else None; print(url.replace('tcp://', '') if url else 'SSH tunnel bulunamadı')"
  ```
- **SSH Komutu (örnek):**
  ```bash
  ssh -p PORT_NUMARASI kullanici_adi@HOST_ADRESI
  ```
  Yukarıdaki komuttan aldığınız adresi kullanın (örn: `ssh -p 15939 basar@2.tcp.eu.ngrok.io`)

### İlk Bilgiler (2025-12-08 14:56:16)
- Proje temelde bir AC charger yapmak için başlatıldı
- Geliştirme ortamı: Raspberry Pi (SSH erişimi, tam yetkiler)
- Mikrodenetleyici: ESP32 (USB bağlantısı)

### Sistem Mimarisi ve Görev Dağılımı (2025-12-08 16:02:06)

#### Görev Ayrımı
- **ESP32:** Fiziksel tarafın sorumluluğu ESP32'nindir
- **Raspberry Pi:** Bilgi alır ve OCPP, API veya web servislerini besler

#### OCPP Desteği (2025-12-08 16:31:39)
- **OCPP Versiyonları:** RPi hem OCPP 2.0.1 hem de OCPP 1.6J destekli olarak CSMS (Central System Management System) ile haberleşebilecektir
- **Çift Versiyon Desteği:** Sistem her iki OCPP versiyonunu da destekleyecek şekilde tasarlanacaktır
- **CSMS Entegrasyonu:** Merkezi sistem yönetimi ile haberleşme OCPP protokolü üzerinden yapılacaktır

#### API ve Endpoint'ler (2025-12-08 16:31:39)
- **API Geliştirme:** RPi'de ESP32'ye gönderilen komutlar için ve ESP32'den durum bilgisi alınabilmesi için API ve endpoint'ler hazırlanacaktır
- **OCPP Bağımsızlığı:** Bu API sayesinde OCPP'den bağımsız olarak da istasyon testler için kullanılabilecektir
- **Test Erişimi:** API üzerinden direkt olarak ESP32 komutları gönderilebilir ve durum bilgileri alınabilir
- **Kullanım Senaryoları:**
  - OCPP üzerinden normal operasyon
  - API üzerinden test ve debug işlemleri
  - OCPP olmadan direkt kontrol ve izleme

#### RPi'den ESP32'ye Gönderilebilecek Komutlar
RPi'den ESP32'ye sadece aşağıdaki komutlar gönderilebilir:

**Tam Komut Listesi (Hex Kod ve Byte Array Formatında):**

| # | Komut | Komut ID | Değer | Hex Kod Dizini | Byte Array (Python) | Byte Array (C/C++) | Açıklama |
|---|-------|----------|-------|----------------|---------------------|-------------------|----------|
| 1 | Status | 00 | 00 | `41 00 2C 00 10` | `[0x41, 0x00, 0x2C, 0x00, 0x10]` | `{0x41, 0x00, 0x2C, 0x00, 0x10}` | İstasyon durumu okuma |
| 2 | Authorization | 01 | 01 | `41 01 2C 01 10` | `[0x41, 0x01, 0x2C, 0x01, 0x10]` | `{0x41, 0x01, 0x2C, 0x01, 0x10}` | Şarj izni ver |
| 3 | Akım Set | 02 | 06 | `41 02 2C 06 10` | `[0x41, 0x02, 0x2C, 0x06, 0x10]` | `{0x41, 0x02, 0x2C, 0x06, 0x10}` | Maksimum akım: 6A |
| 4 | Akım Set | 02 | 0A | `41 02 2C 0A 10` | `[0x41, 0x02, 0x2C, 0x0A, 0x10]` | `{0x41, 0x02, 0x2C, 0x0A, 0x10}` | Maksimum akım: 10A |
| 5 | Akım Set | 02 | 0D | `41 02 2C 0D 10` | `[0x41, 0x02, 0x2C, 0x0D, 0x10]` | `{0x41, 0x02, 0x2C, 0x0D, 0x10}` | Maksimum akım: 13A |
| 6 | Akım Set | 02 | 10 | `41 02 2C 10 10` | `[0x41, 0x02, 0x2C, 0x10, 0x10]` | `{0x41, 0x02, 0x2C, 0x10, 0x10}` | Maksimum akım: 16A ⭐ |
| 7 | Akım Set | 02 | 14 | `41 02 2C 14 10` | `[0x41, 0x02, 0x2C, 0x14, 0x10]` | `{0x41, 0x02, 0x2C, 0x14, 0x10}` | Maksimum akım: 20A |
| 8 | Akım Set | 02 | 19 | `41 02 2C 19 10` | `[0x41, 0x02, 0x2C, 0x19, 0x10]` | `{0x41, 0x02, 0x2C, 0x19, 0x10}` | Maksimum akım: 25A |
| 9 | Akım Set | 02 | 20 | `41 02 2C 20 10` | `[0x41, 0x02, 0x2C, 0x20, 0x10]` | `{0x41, 0x02, 0x2C, 0x20, 0x10}` | Maksimum akım: 32A |
| 10 | State Machine | 04 | 07 | `41 04 2C 07 10` | `[0x41, 0x04, 0x2C, 0x07, 0x10]` | `{0x41, 0x04, 0x2C, 0x07, 0x10}` | Şarjı bitir |

**Önemli Notlar:**
- **Akım Değiştirme Güvenlik Kuralı:** Akım set komutları sadece aktif şarj başlamadan gönderilebilir. Şarj esnasında akım değiştirilemez (güvenlik nedeniyle).
- **Kritik Kural:** Başka komut RPi'den ESP32'ye gitmez.
- Tüm komutlar 5 byte uzunluğundadır.
- Protokol formatı: `41 [KOMUT] 2C [DEĞER] 10`

#### ESP32 Otonom Çalışma
- **State Machine:** ESP32 fiziksel tarafta gelen komutlara ve ev kullanıcısının davranışlarına göre state machine ile çalışır
- **Otonom Yürütme:** ESP32 süreci kendi içinde otonom olarak yürütür
- **Fiziksel Kontrol:** Fiziksel taraftaki tüm kontroller ESP32'nin sorumluluğundadır

---

## Çıkarımlar ve Notlar

### Teknik Çıkarımlar (2025-12-08 14:56:16)
- Raspberry Pi ve ESP32 arasında USB üzerinden iletişim kurulacak
- Tüm kodlar profesyonel standartlarda yazılacak
- Her değişiklik sonrası testler çalıştırılacak

### ESP32-RPi İletişim Protokolü (2025-12-08 15:43:20)
- **Baudrate:** 115200
- **Protokol Formatı:** Binary Hex Protokolü
- **Paket Yapısı:** 5 byte - `41 [KOMUT] 2C [DEĞER] 10`
  - Byte 1: `0x41` (Sabit başlangıç)
  - Byte 2: `[KOMUT]` (Komut kodu, 1 byte hex)
  - Byte 3: `0x2C` (Sabit ayırıcı)
  - Byte 4: `[DEĞER]` (Komut değeri, 1 byte hex)
  - Byte 5: `0x10` (Sabit bitiş)
- **Önemli:** Sadece belirtilen komutlar RPi'den ESP32'ye gönderilebilir

### ESP32 Durum Bilgileri (2025-12-08 15:50:36)
- **ESP32 Kodu:** `/home/basar/charger/esp32/Commercial_08122025.ino`
- **Durum Gönderme:** ESP32'den her 5 saniyede bir durum bilgileri gönderilmektedir
- **sendStat() Fonksiyonu:** `loop()` fonksiyonunda `millis() - lastStatTime >= 7500` kontrolü ile çağrılmaktadır
- **Gönderilen Bilgiler:** CP (Control Pilot), PP (Proximity Pilot), Relay, Lock, Motor, PWM, Max Current, Cable Current, Auth, State, Power Board Status, Stop Requested

### ESP32 Geliştirme Araçları (2025-12-08 15:00:11)
- ESP32 yükleme ve yönetimi için Arduino CLI kullanılacak
- PlatformIO kullanılmayacak

### Geliştirme Ortamı (2025-12-08 14:59:29)
- Proje geliştirme süreci (env) virtual environment ile yönetilecektir
- Terminal açıldığında otomatik olarak virtual ortamda açılacak ve kodlar orada yürütülecektir
- Poetry kullanılmayacak, bunun yerine Python virtual environment (env) kullanılacak

---

## Önemli Noktalar ve Hatırlanması Gerekenler

### Kritik Dosyalar (2025-12-08 14:57:30)
- `/home/basar/charger/project_info_20251208_145614.md` ve `/home/basar/charger/.cursorrules` dosyaları her zaman güncel tutulacaktır.
- Bu dosyalar proje süresince sürekli güncellenecek ve bakımı yapılacaktır.

### Çalışma Dizini ve Kısıtlamalar (2025-12-08 15:17:41)
- **Çalışma Dizini:** /home/basar/charger
- Dosya, klasör, alt klasör, ikilik (binary) yaratacak durumlara izin verilmeyecektir
- Kod standardı tüm workspace ve projede korunacaktır
- Tüm geliştirme çalışmaları bu dizin içinde yapılacaktır

### Çalışma Prensipleri (2025-12-08 15:19:35)
- Varsayımlarla değil gerçek verilerle hareket edilecektir
- Sistemde birşey yapılması gerektiğinde erişilemez veya SSH gerekli gibi varsayılmayacaktır
- Direkt terminalden herşey yapılabilir durumdadır
- Tüm işlemler terminal üzerinden gerçek verilerle yapılacaktır

### ESP32-RPi USB Bağlantı Kontrolü ve İzleme (2025-12-08 15:53:47)
- **Sorun Tespiti:** Herhangi bir sorun olduğunda ESP32 ve RPi arasında fiziksel bir sorun var mı diye bakmak için istenildiği zaman RPi'den USB'yi kullanabilecek herhangi bir şey var mı diye kontrol edilmelidir
- **USB Temizleme:** Gerekirse USB'yi temizleyip 115200 baudrate ile izleme yapılmalıdır
- **İzleme Süresi:** ESP32'den rutin bilgi formatı geliyor mu kontrolü için 10-15 saniye izleme yapılmalıdır
- **Baudrate:** 115200
- **Kontrol Mekanizması:** USB bağlantısını kontrol etmek, USB'yi temizlemek ve izleme yapmak için gerekli araçlar kullanılmalıdır
- **Beklenen Davranış:** ESP32'den her 5 saniyede bir `<STAT;...>` formatında durum bilgileri gelmelidir
- **Durum Değerlendirme Kriteri:** Rutin bilgiler gelmeye devam ettikçe ESP32'nin durumunun aktif ve sorunsuz olduğu kabul edilmelidir

_(Bu bölüm çalışmalar ilerledikçe güncellenecek)_

---

## Proje Planlama ve Değerlendirme

### Mevcut Durum Analizi (2025-12-08 16:32:52)

#### Toplanan Bilgiler Özeti
1. **Proje Temeli:**
   - AC Charger geliştirme projesi
   - Raspberry Pi (SSH bağlı, tam yetkiler) + ESP32 (USB bağlantılı)
   - Çalışma dizini: `/home/basar/charger`

2. **Sistem Mimarisi:**
   - ESP32: Fiziksel tarafın sorumluluğu, otonom state machine ile çalışma
   - RPi: OCPP, API ve web servisleri, bilgi toplama ve yönetim

3. **İletişim Protokolü:**
   - Baudrate: 115200
   - Protokol: Binary Hex (`41 [KOMUT] 2C [DEĞER] 10`, 5 byte)
   - ESP32'den her 5 saniyede durum bilgisi (`<STAT;...>` formatında)

4. **Komutlar:**
   - 10 komut tanımlı (Status, Authorization, Akım Set x7, State Machine)
   - Tüm komutlar dokümante edildi (hex kod, byte array formatları)

5. **OCPP Desteği:**
   - OCPP 2.0.1 ve OCPP 1.6J desteği planlandı
   - CSMS entegrasyonu

6. **API ve Endpoint'ler:**
   - ESP32 komutları ve durum bilgileri için API geliştirilecek
   - OCPP bağımsız test erişimi

#### Mevcut Dosya Durumu
- ✅ `esp32/Commercial_08122025.ino` - ESP32 kodu mevcut (1438 satır)
- ⚠️ `esp32/bridge.py` - Boş (ESP32-RPi köprü modülü geliştirilmeli)
- ⚠️ `esp32/protocol.json` - Boş (Protokol tanımları eklenmeli)
- ⚠️ `ocpp/main.py` - Basit placeholder (OCPP implementasyonu gerekli)
- ⚠️ `ocpp/handlers.py` - Boş (OCPP handler'ları geliştirilmeli)
- ⚠️ `ocpp/states.py` - Boş (OCPP state yönetimi gerekli)
- ⚠️ `meter/read_meter.py` - Boş (Meter okuma modülü geliştirilmeli)

#### Geliştirme Öncelikleri

**Faz 1: Temel Altyapı (Kritik)**
1. ESP32-RPi Bridge Modülü (`esp32/bridge.py`)
   - USB seri port bağlantısı (115200 baudrate)
   - Komut gönderme fonksiyonları (10 komut)
   - Durum bilgisi okuma ve parse etme
   - Hata yönetimi ve bağlantı kontrolü

2. Protokol Tanımları (`esp32/protocol.json`)
   - Komut tanımları ve byte array formatları
   - Durum mesajı formatı ve parse kuralları
   - Hata kodları ve açıklamaları

**Faz 2: API Katmanı**
3. REST API Geliştirme
   - ESP32 komutları için endpoint'ler
   - Durum bilgisi endpoint'leri
   - Test ve debug endpoint'leri
   - API dokümantasyonu

**Faz 3: OCPP Entegrasyonu**
4. OCPP 1.6J Implementasyonu
   - WebSocket bağlantı yönetimi
   - Temel OCPP mesajları (Authorize, StartTransaction, StopTransaction, StatusNotification)
   - CSMS entegrasyonu

5. OCPP 2.0.1 Implementasyonu
   - OCPP 2.0.1 protokol desteği
   - Yeni özellikler ve mesajlar
   - Çift versiyon desteği

**Faz 4: Meter ve Monitoring**
6. Meter Okuma Modülü (`meter/read_meter.py`)
   - Enerji ölçüm cihazı entegrasyonu
   - Veri toplama ve işleme
   - Loglama

7. Monitoring ve Logging
   - Sistem durumu izleme
   - Hata loglama
   - Performans metrikleri

**Faz 5: Test ve Optimizasyon**
8. Test Suite
   - Unit testler
   - Entegrasyon testleri
   - ESP32-RPi iletişim testleri
   - OCPP protokol testleri

9. Dokümantasyon ve Deployment
   - API dokümantasyonu
   - Kurulum kılavuzu
   - Sistem mimarisi dokümantasyonu

#### Teknik Gereksinimler

**Python Kütüphaneleri:**
- `pyserial` - USB seri port iletişimi
- `fastapi` veya `flask` - REST API
- `websockets` - OCPP WebSocket bağlantıları
- `pydantic` - Veri validasyonu
- `python-ocpp` - OCPP protokol kütüphanesi (varsa)

**Geliştirme Araçları:**
- Python virtual environment (env)
- Git ve GitHub
- Arduino CLI (ESP32 için)

#### Riskler ve Dikkat Edilmesi Gerekenler
1. **USB Bağlantı Güvenilirliği:** USB bağlantısının kesilmesi durumunda hata yönetimi
2. **ESP32 Durum Takibi:** ESP32'den gelen durum mesajlarının sürekli izlenmesi
3. **OCPP Versiyon Uyumluluğu:** İki OCPP versiyonunun aynı anda desteklenmesi
4. **Güvenlik:** API endpoint'lerinin güvenliği ve yetkilendirme
5. **Akım Değiştirme Güvenliği:** Şarj esnasında akım değiştirme engellemesi

#### Sonraki Adımlar
1. ESP32-RPi bridge modülünün geliştirilmesi
2. Protokol tanımlarının JSON formatında hazırlanması
3. Temel API endpoint'lerinin oluşturulması
4. OCPP implementasyonuna başlanması

---

## Hatalardan Çıkarılan Dersler

_(Bu bölüm karşılaşılan hatalar ve çözümleri ile güncellenecek)_

---

## Edinilen ve Öğrenilen Bilgiler

### ESP32 Hex Komut Protokolü (2025-12-08 15:43:20)

#### Protokol Mimarisi
ESP32 şarj istasyonu kontrol ünitesi, üretici tarafından tanımlanan binary hex protokolünü kullanmaktadır. Protokol, sabit başlangıç ve bitiş byte'ları ile komut ve değer parametrelerinden oluşur.

#### Protokol Yapısı
**Genel Format:** `41 [KOMUT] 2C [DEĞER] 10`

| Byte Pozisyonu | Hex Değer | Açıklama | Tip |
|----------------|-----------|----------|-----|
| 1 | 41 | Sabit başlangıç byte'ı | Constant |
| 2 | [KOMUT] | Komut kodu (1 byte, hex) | Variable |
| 3 | 2C | Sabit ayırıcı byte | Constant |
| 4 | [DEĞER] | Komut değeri (1 byte, hex) | Variable |
| 5 | 10 | Sabit bitiş byte'ı | Constant |

**Toplam Paket Uzunluğu:** 5 byte

#### ESP32'ye Gönderilen Komutlar

| # | Komut Kategorisi | Komut ID | Değer | Hex Kod Dizini | Açıklama | Durum |
|---|-------------------|----------|-------|----------------|----------|-------|
| 1 | Status | 00 | 00 | 41 00 2C 00 10 | İstasyon durumu okuma | ✅ Aktif |
| 2 | Authorization | 01 | 01 | 41 01 2C 01 10 | Şarj izni ver | ✅ Aktif* |
| 4 | Akım Set | 02 | 06 | 41 02 2C 06 10 | Maksimum akım: 6A | ✅ Aktif |
| 5 | Akım Set | 02 | 0A | 41 02 2C 0A 10 | Maksimum akım: 10A | ✅ Aktif |
| 6 | Akım Set | 02 | 0D | 41 02 2C 0D 10 | Maksimum akım: 13A | ✅ Aktif |
| 7 | Akım Set | 02 | 10 | 41 02 2C 10 10 | Maksimum akım: 16A ⭐ | ✅ Aktif |
| 8 | Akım Set | 02 | 14 | 41 02 2C 14 10 | Maksimum akım: 20A | ✅ Aktif |
| 9 | Akım Set | 02 | 19 | 41 02 2C 19 10 | Maksimum akım: 25A | ✅ Aktif |
| 10 | Akım Set | 02 | 20 | 41 02 2C 20 10 | Maksimum akım: 32A | ✅ Aktif |
| 20 | State Machine | 04 | 07 | 41 04 2C 07 10 | Şarjı bitir | ✅ Aktif* |

**Not:** Sadece bu komutlar RPi'den ESP32'ye gönderilebilir.

#### Komut ID (KOMUT) Anlamları

| Komut ID | Hex | İkili | Komut Adı | Açıklama |
|----------|-----|-------|-----------|----------|
| 00 | 0x00 | 00000000 | Status | İstasyon durumu okuma komutu |
| 01 | 0x01 | 00000001 | Authorization | Şarj izni kontrolü |
| 02 | 0x02 | 00000010 | Akım Set | Maksimum akım ayarlama |
| 04 | 0x04 | 00000100 | State Machine | Durum makinesi kontrolü |

#### Değer (DEĞER) Anlamları

**Authorization Komutları (cmd_id=01)**
| Değer | Hex | İkili | Anlam | Açıklama |
|-------|-----|-------|-------|----------|
| 01 | 0x01 | 00000001 | Authorization Ver | Şarj izni ver, şarja hazır |

**Akım Set Komutları (cmd_id=02)**
| Değer | Hex | İkili | Amper (A) | Açıklama |
|-------|-----|-------|-----------|----------|
| 06 | 0x06 | 00000110 | 6A | Minimum akım |
| 0A | 0x0A | 00001010 | 10A | Düşük akım |
| 0D | 0x0D | 00001101 | 13A | Orta akım |
| 10 | 0x10 | 00010000 | 16A | Önerilen akım ⭐ |
| 14 | 0x14 | 00010100 | 20A | Yüksek akım |
| 19 | 0x19 | 00011001 | 25A | Çok yüksek akım |
| 20 | 0x20 | 00100000 | 32A | Maksimum akım |

**Not:** Değer doğrudan amper cinsinden gönderilir (hex formatında).

**State Machine Komutları (cmd_id=04)**
| Değer | Hex | İkili | Durum Adı | Açıklama |
|-------|-----|-------|-----------|----------|
| 07 | 0x07 | 00000111 | Finishing | Şarjı bitir |

#### Protokol Örneği
**Status Komutu:**
- KOMUT: 00 (Status komutu)
- DEĞER: 00 (Status okuma)
- Hex Dizini: `41 00 2C 00 10`
- Byte Array: `[0x41, 0x00, 0x2C, 0x00, 0x10]`

_(Bu bölüm proje süresince edinilen teknik bilgiler ile güncellenecek)_

---

## Versiyon Geçmişi

### Version 1.3.7 (2025-12-08 17:19:00)
- Ngrok yapılandırması optimize edildi
- Gereksiz TCP tunnel kaldırıldı (port 29229)
- HTTP tunnel WebSocket desteği eklendi (CSMS/OCPP için)
- Dokümantasyon güncellendi: API, Web ve CSMS erişimi tek HTTP tunnel üzerinden
- SSH tunnel korundu (dinamik adres)
- Tüm erişim yöntemleri net bir şekilde dokümante edildi

### Version 1.3.6 (2025-12-08 17:17:00)
- SSH tunnel eklendi (port 22 için)
- Dışarıdan SSH erişimi için yapılandırma tamamlandı
- SSH tunnel kullanım talimatları dokümante edildi
- Tunnel adresini dinamik olarak öğrenme komutu eklendi

### Version 1.3.5 (2025-12-08 17:14:30)
- Ngrok dokümantasyonu tek bir bölümde birleştirildi
- TCP reserved address yapılandırması düzeltildi (`remote_addr` parametresi eklendi)
- Tüm Ngrok bilgileri tutarlı ve tek bir yerde toplandı
- Kafa karışıklığını önlemek için dokümantasyon düzenlendi

### Version 1.3.4 (2025-12-08 17:13:10)
- Ngrok sistem servisi olarak kuruldu ve başlatıldı
- Otomatik başlatma aktif (systemd enabled)
- HTTP tunnel aktif: https://lixhium.ngrok.app dışarıdan erişilebilir
- TCP tunnel aktif (rastgele adres atandı)
- Servis yönetim komutları dokümante edildi
- Dışarıdan erişim hazır durumda

### Version 1.3.3 (2025-12-08 17:07:54)
- Ngrok Dashboard API kontrolü tamamlandı
- API key başarıyla yapılandırma dosyasına eklendi
- Reserved domain kontrolü: lixhium.ngrok.app doğrulandı (rd_2xYXpwyNNgABarNketjeXYIKzQ4)
- Reserved TCP address kontrolü: ra_31mBecHpZPIZvsRNAoX3PPOnyWr doğrulandı (9.tcp.eu.ngrok.io:29229)
- Tüm yapılandırmalar doğru ve geçerli

### Version 1.3.2 (2025-12-08 17:06:05)
- Ngrok kurulumu tamamlandı (v3.34.0)
- Ngrok yapılandırması test edildi ve doğrulandı
- HTTP tunnel testi başarılı: https://lixhium.ngrok.app dışarıdan erişilebilir
- TCP tunnel testi yapıldı (reserved address için API kullanımı gerekli)
- Test sonuçları dokümante edildi

### Version 1.3.1 (2025-12-08 16:59:59)
- Ngrok yapılandırması eklendi
- HTTP/HTTPS tunnel: lixhium.ngrok.app domain'i yapılandırıldı
- TCP tunnel: Reserved TCP address (ra_31mBecHpZPIZvsRNAoX3PPOnyWr) yapılandırıldı
- Ngrok kimlik doğrulama bilgileri dokümante edildi

### Version 1.3.0 (2025-12-08 16:32:52)
- Proje planlama ve değerlendirme bölümü eklendi
- Mevcut durum analizi yapıldı
- Geliştirme öncelikleri belirlendi (5 faz)
- Teknik gereksinimler listelendi
- Riskler ve dikkat edilmesi gerekenler dokümante edildi
- Sonraki adımlar planlandı

### Version 1.2.2 (2025-12-08 16:31:39)
- OCPP desteği eklendi: RPi hem OCPP 2.0.1 hem de OCPP 1.6J destekli olarak CSMS ile haberleşebilecek
- API ve endpoint'ler dokümante edildi: ESP32 komutları ve durum bilgileri için API hazırlanacak
- OCPP bağımsız test erişimi belirtildi: API sayesinde OCPP olmadan da istasyon test edilebilecek

### Version 1.2.1 (2025-12-08 16:03:43)
- RPi'den ESP32'ye gönderilebilecek tüm komutların tam kodları eklendi
- Hex kod dizini, Python byte array ve C/C++ byte array formatları dokümante edildi
- Tüm komutlar tablo formatında listelendi (10 komut)

### Version 1.2.0 (2025-12-08 16:02:06)
- Sistem mimarisi ve görev dağılımı dokümante edildi
- ESP32 ve RPi görev ayrımı belirtildi
- RPi'den ESP32'ye gönderilebilecek komutlar listelendi (şarj başlatma, durum alma, şarj sonlandırma, akım değiştirme)
- Akım değiştirme güvenlik kuralı eklendi: sadece şarj başlamadan yapılabilir
- ESP32'nin otonom çalışma ve state machine yapısı belirtildi
- Kritik kural: Başka komut RPi'den ESP32'ye gitmez

### Version 1.1.2 (2025-12-08 15:54:53)
- ESP32 durum değerlendirme kriteri eklendi: rutin bilgiler gelmeye devam ettikçe ESP32'nin aktif ve sorunsuz olduğu kabul edilir

### Version 1.1.1 (2025-12-08 15:53:47)
- ESP32-RPi USB bağlantı kontrolü ve izleme mekanizması eklendi
- Sorun tespiti için USB kontrolü ve temizleme prosedürü belirtildi
- 115200 baudrate ile izleme ve 10-15 saniye kontrol süresi dokümante edildi

### Version 1.1.0 (2025-12-08 15:50:36)
- ESP32 durum bilgileri eklendi: her 5 saniyede bir durum gönderiliyor
- ESP32 kod dosyası belirtildi: Commercial_08122025.ino
- sendStat() fonksiyonu ve durum gönderme mekanizması dokümante edildi

### Version 1.0.9 (2025-12-08 15:43:20)
- ESP32-RPi USB iletişim protokolü detayları eklendi
- Baudrate: 115200 belirtildi
- Hex komut protokolü formatı ve tüm komutlar dokümante edildi
- Protokol yapısı, komut ID'leri ve değer anlamları tablolar halinde eklendi

### Version 1.0.8 (2025-12-08 15:19:35)
- Çalışma prensipleri eklendi: varsayımlarla değil gerçek verilerle hareket edilecek
- Terminal erişimi kuralı eklendi: direkt terminalden herşey yapılabilir durumda
- SSH gerekli gibi varsayımlar yapılmayacak

### Version 1.0.7 (2025-12-08 15:17:41)
- Çalışma dizini belirtildi: /home/basar/charger
- Dosya, klasör, alt klasör, ikilik yaratma kısıtlaması eklendi
- Kod standardının tüm workspace ve projede korunması gerektiği belirtildi

### Version 1.0.6 (2025-12-08 15:15:35)
- Git repository başlatıldı ve ilk commit yapıldı
- SSH key oluşturuldu ve GitHub'a eklendi
- İlk push başarıyla tamamlandı (10 dosya, 1622 satır)
- GitHub repository ile sync kuruldu

### Version 1.0.5 (2025-12-08 15:06:06)
- GitHub repository bilgisi eklendi (https://github.com/CaiserSz/orge1.git)
- GitHub sync ve commit/push işlemleri için özen gösterilmesi gerektiği belirtildi

### Version 1.0.4 (2025-12-08 15:00:11)
- ESP32 yükleme ve yönetimi için Arduino CLI kullanılacağı belirtildi
- PlatformIO yerine Arduino CLI kullanılacak

### Version 1.0.3 (2025-12-08 14:59:29)
- Geliştirme ortamı bilgisi güncellendi: Poetry yerine (env) virtual environment kullanılacak
- Terminal açıldığında otomatik olarak virtual ortamda açılacağı belirtildi

### Version 1.0.2 (2025-12-08 14:57:30)
- Kritik dosyaların her zaman güncel tutulması kuralı eklendi
- project_info ve .cursorrules dosyalarının sürekli güncellenmesi gerektiği belirtildi

### Version 1.0.1 (2025-12-08 14:56:59)
- Dosya adı İngilizceye çevrildi (proje_bilgileri -> project_info)
- Dosya isimlerinin her zaman İngilizce olması kuralı eklendi

### Version 1.0.0 (2025-12-08 14:56:16)
- İlk dosya oluşturuldu
- Proje genel bilgileri eklendi
- Dosya yapısı ve formatı belirlendi

