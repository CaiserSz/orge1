# Proje Bilgileri - AC Charger

## KRÄ°TÄ°K GELÄ°ÅTÄ°RME KURALI: Test ve Teyit ZorunluluÄŸu

**Ã–NEMLÄ°:** TÃ¼m test ve teyit kurallarÄ± iÃ§in tek kaynak: [`.cursorrules`](.cursorrules) dosyasÄ±na bakÄ±nÄ±z.

**Ã–zet:**
- Agent, kullanÄ±cÄ±ya teslim etmeden Ã¶nce MUTLAKA test edip teyit etmelidir
- Test zamanlamasÄ± kurallarÄ±na uyulmalÄ±dÄ±r (her dosya editinden sonra tÃ¼m test suite'i Ã§alÄ±ÅŸtÄ±rÄ±lmaz)
- Browser testleri, external eriÅŸim testleri ve sayfa fonksiyon testleri gerektiÄŸinde yapÄ±lmalÄ±dÄ±r

**DetaylÄ± kurallar:** [`.cursorrules`](.cursorrules) dosyasÄ±ndaki "KRÄ°TÄ°K KURAL: Test ve Teyit ZorunluluÄŸu" bÃ¶lÃ¼mÃ¼ne bakÄ±nÄ±z.

---

## KÃ¼nye

**Dosya AdÄ±:** project_info_20251208_145614.md
**YaratÄ±lma Tarihi:** 2025-12-08 14:56:16
**Son DeÄŸiÅŸtirilme Tarihi:** 2025-12-16 10:06:00
**Version:** 2.5.13
**Ã–zet:** AC charger projesi iÃ§in proje bilgileri, Ã¶nemli notlar, dersler ve edinilen bilgilerin tutulduÄŸu ana dokÃ¼mantasyon dosyasÄ±.
**NOT:** Bu dosya bÃ¶lÃ¼mlere ayrÄ±lmÄ±ÅŸtÄ±r. DetaylÄ± bilgiler iÃ§in aÅŸaÄŸÄ±daki linklere bakÄ±nÄ±z.

---

## Proje Genel Bilgileri

### Proje AmacÄ±
AC charger geliÅŸtirme projesi.

### DonanÄ±m AltyapÄ±sÄ±
- **Raspberry Pi:** SSH ile baÄŸlÄ±, tam yetkilere sahip
- **ESP32:** USB Ã¼zerinden Raspberry Pi'ye baÄŸlÄ±

### Sistem Bilgileri (2025-12-08 19:10:00)
- **Ä°ÅŸletim Sistemi:** Debian GNU/Linux 13 (Trixie)
- **Kernel:** Linux 6.12.47+rpt-rpi-v8 (Raspberry Pi kernel)
- **Architecture:** aarch64
- **Network YÃ¶netimi:** NetworkManager (aktif)
- **WiFi:** wlan0 (BCM4345/6 chipset)
- **Not:** RPi Lite deÄŸil, Debian tabanlÄ± sistem

### Versiyon KontrolÃ¼ ve Repository (2025-12-08 15:06:06)
- **GitHub Repository:** https://github.com/CaiserSz/orge1.git
- GitHub repository ile sync gidilmesi ve local'in commit/push edilmesi iÃ§in Ã¶zen gÃ¶sterilecektir
- Git ve GitHub sÃ¼rekli aktif olarak commit edilecektir

### Ä°lk Bilgiler (2025-12-08 14:56:16)
- Proje temelde bir AC charger yapmak iÃ§in baÅŸlatÄ±ldÄ±
- GeliÅŸtirme ortamÄ±: Raspberry Pi (SSH eriÅŸimi, tam yetkiler)
- Mikrodenetleyici: ESP32 (USB baÄŸlantÄ±sÄ±)

### Sistem Mimarisi ve GÃ¶rev DaÄŸÄ±lÄ±mÄ± (Genel BakÄ±ÅŸ)

#### GÃ¶rev AyrÄ±mÄ±
- **ESP32:** Fiziksel tarafÄ±n sorumluluÄŸu ESP32'nindir
- **Raspberry Pi:** Bilgi alÄ±r ve OCPP, API veya web servislerini besler

#### OCPP DesteÄŸi (2025-12-08 16:31:39)
- **OCPP VersiyonlarÄ±:** RPi hem OCPP 2.0.1 hem de OCPP 1.6J destekli olarak CSMS (Central System Management System) ile haberleÅŸebilecektir
- **Ã‡ift Versiyon DesteÄŸi:** Sistem her iki OCPP versiyonunu da destekleyecek ÅŸekilde tasarlanacaktÄ±r
- **CSMS Entegrasyonu:** Merkezi sistem yÃ¶netimi ile haberleÅŸme OCPP protokolÃ¼ Ã¼zerinden yapÄ±lacaktÄ±r

#### API ve Endpoint'ler (Genel BakÄ±ÅŸ)
- **API GeliÅŸtirme:** RPi'de ESP32'ye gÃ¶nderilen komutlar iÃ§in ve ESP32'den durum bilgisi alÄ±nabilmesi iÃ§in API ve endpoint'ler hazÄ±rlanacaktÄ±r
- **OCPP BaÄŸÄ±msÄ±zlÄ±ÄŸÄ±:** Bu API sayesinde OCPP'den baÄŸÄ±msÄ±z olarak da istasyon testler iÃ§in kullanÄ±labilecektir
- **Test EriÅŸimi:** API Ã¼zerinden direkt olarak ESP32 komutlarÄ± gÃ¶nderilebilir ve durum bilgileri alÄ±nabilir

**DetaylÄ± bilgiler iÃ§in:** [API ReferansÄ±](docs/api_reference.md)

---

## DokÃ¼mantasyon Linkleri

Bu dokÃ¼mantasyon bÃ¶lÃ¼mlere ayrÄ±lmÄ±ÅŸtÄ±r. DetaylÄ± bilgiler iÃ§in aÅŸaÄŸÄ±daki dosyalara bakÄ±nÄ±z:

### ğŸ“š Ana DokÃ¼mantasyon
- **[API ReferansÄ±](docs/api_reference.md)** - REST API endpoint'leri, ESP32 protokolÃ¼, API Ã¶rnekleri
- **[Sistem Mimarisi](docs/architecture.md)** - Sistem mimarisi, modÃ¼l yapÄ±sÄ±, veri akÄ±ÅŸÄ±
- **[CSMS BaÄŸlantÄ± Parametreleri](docs/csms/CSMS_CONNECTION_PARAMETERS.md)** - OCPP WS/WSS URLâ€™leri, BasicAuth, Phase-1 test parametreleri
- **[Deployment KÄ±lavuzu](docs/deployment.md)** - Kurulum, yapÄ±landÄ±rma, servis yÃ¶netimi
- **[Sorun Giderme](docs/troubleshooting.md)** - Sorun giderme, log analizi, hata kodlarÄ±

### ğŸ“‹ Proje YÃ¶netimi
- **[START_HERE.md](todo/START_HERE.md)** - âš¡ Projeye devam etmek iÃ§in baÅŸlangÄ±Ã§ noktasÄ±
- **[checkpoint.md](todo/checkpoint.md)** - Nerede kaldÄ±k? HÄ±zlÄ± durum kontrolÃ¼
- **[project_state.md](todo/project_state.md)** - DetaylÄ± proje durumu ve ilerleme takibi
- **[master_next.md](todo/master_next.md)** - Sonraki yapÄ±lacaklar listesi

### ğŸ“Š Analiz ve DeÄŸerlendirmeler
- **[Multi-Expert Analiz](reports/MULTI_EXPERT_ANALYSIS.md)** - Multi-expert analiz raporu
- **[Security Audit](reports/AUDIT_REPORT_20251209.md)** - Security audit raporu
- **[Logging Audit](reports/LOGGING_AUDIT.md)** - Logging sistemi audit raporu
- **[Deep Dive Analiz](reports/DEEP_DIVE_ANALYSIS_20251210.md)** - Deep dive analiz raporu
- **[Codebase Deep Dive Analiz](reports/CODEBASE_DEEPDIVE_ANALYSIS_20251210.md)** - Codebase deep dive analiz raporu
- **[RPi Stratejik Analiz](reports/RPI_STRATEGIC_ANALYSIS.md)** - RPi stratejik analiz raporu
- **[RPi Aksiyon PlanÄ±](reports/RPI_ACTION_PLAN.md)** - RPi aksiyon planÄ±
- **[ESP32 Tavsiye Raporu](reports/ESP32_FIRMWARE_ADVISORY_REPORT.md)** - ESP32 firmware tavsiye raporu
- **[Analiz Ignore Listesi](docs/ANALYSIS_IGNORE_LIST.md)** - Analizlerde ignore edilecek konular
- **[TÃ¼m Analiz RaporlarÄ±](reports/)** - TÃ¼m analiz ve audit raporlarÄ±

---

## Ã–nemli Noktalar ve HatÄ±rlanmasÄ± Gerekenler

### Kritik Dosyalar (2025-12-08 14:57:30)
- `/home/basar/charger/project_info_20251208_145614.md` ve `/home/basar/charger/.cursorrules` dosyalarÄ± her zaman gÃ¼ncel tutulacaktÄ±r.
- Bu dosyalar proje sÃ¼resince sÃ¼rekli gÃ¼ncellenecek ve bakÄ±mÄ± yapÄ±lacaktÄ±r.
- **DokÃ¼man ArÅŸivi:** 2025-12-12 21:12:00 itibarÄ±yla `docs/acrel/` klasÃ¶rÃ¼ `.gitignore` kapsamÄ±ndadÄ±r; yÃ¼ksek boyutlu Acrel PDF/JPEG seti yalnÄ±zca lokal referans iÃ§in tutulacak, git geÃ§miÅŸine dahil edilmeyecektir.
- **Workspace Hijyen Notu (2025-12-13 01:00:00):** Logs klasÃ¶rÃ¼ sÄ±fÄ±rlandÄ± (`du -sh logs` â‰ˆ 0.01 MB) ve `python3 scripts/workspace_auto_check.py` Ã§Ä±ktÄ±sÄ±na gÃ¶re env/logs hariÃ§ toplam boyut 29.13 MB. env/ sanal ortamÄ± 102 MB olduÄŸundan (warning eÅŸiÄŸi) kÃ¼Ã§Ã¼ltme/gÃ¶Ã§ planÄ± `master_next.md` iÃ§ine alÄ±ndÄ±.
- **Standart Refactor Notu (2025-12-13 02:45:00):** Env 76.7 MB seviyesinde; `api/cache_backend.py`, `api/logging_setup.py`, `api/event_types.py`, `api/alerting_models.py`, `api/session/events_logging.py`, `api/session/events_lifecycle.py`, `api/database/schema_mixin.py`, `api/services/health_service.py` gibi yeni modÃ¼llerle uzun dosyalar bÃ¶lÃ¼ndÃ¼. Ä°lgili test dosyalarÄ± ayrÄ± suiteâ€™lere ayrÄ±ldÄ± (`tests/test_session_model.py`, `tests/test_session_manager_integration.py`, `tests/test_event_detector_integration.py`, `tests/test_command_protocol.py`, `tests/test_protocol_rules.py`).
- **Test/Coverage GÃ¼ncellemesi (2025-12-16 10:06:00):** Testler geniÅŸletildi ve coverage Ã¶lÃ§Ã¼mÃ¼ gÃ¼ncellendi. TOTAL coverage **%58 â†’ %62**. Ã–zellikle `api/routers/meter.py` **%17 â†’ %78**, `ocpp/states.py` **%0 â†’ %78**, `ocpp/main.py` **%0 â†’ %44**, `ocpp/handlers.py` **%0 â†’ %15**. Kalan bÃ¼yÃ¼k boÅŸluklar: `meter/read_meter.py` ve `api/meter/acrel.py` hÃ¢lÃ¢ **%0**.

### Todo Sistemi (2025-12-08 18:20:00)

**Todo KlasÃ¶rÃ¼:** `/home/basar/charger/todo/`

**Dosyalar:**
- `START_HERE.md` - âš¡ Projeye devam etmek iÃ§in baÅŸlangÄ±Ã§ noktasÄ± (Ã–NCE BUNU OKU!)
- `checkpoint.md` - Nerede kaldÄ±k? HÄ±zlÄ± durum kontrolÃ¼
- `project_state.md` - DetaylÄ± proje durumu ve ilerleme takibi
- `ai_workflow.md` - AI asistanlarÄ± iÃ§in Ã§alÄ±ÅŸma akÄ±ÅŸÄ± ve kurallar
- `master.md` - Genel bilgiler, kurallar ve info noktalarÄ±
- `master_next.md` - Sonraki yapÄ±lacaklar listesi (Ã¶ncelik sÄ±rasÄ±na gÃ¶re)
- `master_live.md` - Åu anda aktif olarak yapÄ±lan iÅŸler (maksimum 2-3 gÃ¶rev)
- `master_done.md` - Tamamlanan iÅŸler (tarih ve detaylarla)
- `expert_recommendations.md` - KÄ±demli uzman Ã¶nerileri ve best practices

**KullanÄ±m:** Proje yÃ¶netimi ve gÃ¶rev takibi iÃ§in kullanÄ±lÄ±r

**Otonom Ã‡alÄ±ÅŸma:** AI asistanlarÄ± projeye devam ettiÄŸinde `START_HERE.md` dosyasÄ±nÄ± okuyarak nerede kaldÄ±ÄŸÄ±nÄ± anlayabilir ve proaktif Ã§alÄ±ÅŸabilir

**GÃ¼ncelleme:** GÃ¶revler tamamlandÄ±kÃ§a `master_done.md`'ye taÅŸÄ±nÄ±r, aktif gÃ¶revler `master_live.md`'ye eklenir, durum `project_state.md` ve `checkpoint.md`'de gÃ¼ncellenir

### Ã‡alÄ±ÅŸma Dizini ve KÄ±sÄ±tlamalar (2025-12-08 15:17:41)
- **Ã‡alÄ±ÅŸma Dizini:** /home/basar/charger
- Dosya, klasÃ¶r, alt klasÃ¶r, ikilik (binary) yaratacak durumlara izin verilmeyecektir
- Kod standardÄ± tÃ¼m workspace ve projede korunacaktÄ±r
- TÃ¼m geliÅŸtirme Ã§alÄ±ÅŸmalarÄ± bu dizin iÃ§inde yapÄ±lacaktÄ±r

### Ã‡alÄ±ÅŸma Prensipleri (2025-12-08 15:19:35)
- VarsayÄ±mlarla deÄŸil gerÃ§ek verilerle hareket edilecektir
- Sistemde birÅŸey yapÄ±lmasÄ± gerektiÄŸinde eriÅŸilemez veya SSH gerekli gibi varsayÄ±lmayacaktÄ±r
- Direkt terminalden herÅŸey yapÄ±labilir durumdadÄ±r
- TÃ¼m iÅŸlemler terminal Ã¼zerinden gerÃ§ek verilerle yapÄ±lacaktÄ±r

---

## Sahadaki Son Durum (2025-12-11 13:40:00)

- **Genel Durum**
  - GerÃ§ek araÃ§ ile yapÄ±lan testlerde API, ESP32 bridge, session yÃ¶netimi, logging, event detection ve rate limiting mekanizmalarÄ± sorunsuz Ã§alÄ±ÅŸtÄ±.
  - Birden fazla ÅŸarj dÃ¶ngÃ¼sÃ¼ boyunca state geÃ§iÅŸleri (`IDLE â†’ CABLE_DETECT â†’ EV_CONNECTED â†’ READY â†’ CHARGING â†’ PAUSED/STOPPED â†’ IDLE`) hem `logs/system.log` hem de `logs/esp32.log` iÃ§inde tutarlÄ± ÅŸekilde kaydedildi.
  - Her ÅŸarj dÃ¶ngÃ¼sÃ¼ iÃ§in `SESSION_STARTED` / `SESSION_ENDED` event'leri ve sÃ¼re/metrik bilgileri doÄŸru ÅŸekilde Ã¼retildi.

- **AraÃ§ TarafÄ± DavranÄ±ÅŸÄ± (SOC Limiti)**
  - AraÃ§ BMS'inde SOC limiti %60 iken, istasyon READY ve authorization verilmiÅŸ olmasÄ±na raÄŸmen araÃ§ ÅŸarjÄ± baÅŸlatmadÄ± (iÃ§ kontaktÃ¶rleri kapatmadÄ±); istasyon tarafÄ± doÄŸru olarak READY/EV_CONNECTED state'lerinde bekledi.
  - KullanÄ±cÄ± davranÄ±ÅŸsal olarak bu durumu ilk anda "ÅŸarj baÅŸlamÄ±yor" ÅŸeklinde algÄ±ladÄ± ve birkaÃ§ kez start/stop denemesi yapmak zorunda kaldÄ±.
  - SOC limiti %80'e Ã§ekildikten sonra araÃ§ ilk denemede ÅŸarjÄ± baÅŸlattÄ±; istasyonda `CHARGING` state'ine geÃ§iÅŸ ve akÄ±m akÄ±ÅŸÄ± normal biÃ§imde gerÃ§ekleÅŸti.
  - DeÄŸerlendirme: Bu durum istasyon tarafÄ±nda bir hata deÄŸil, **araÃ§ BMS/SOC limiti kaynaklÄ± beklenen bir senaryo**; ileride UI/API seviyesinde "READY uzun sÃ¼rÃ¼yor ve akÄ±m yoksa, araÃ§ SOC limitte olabilir" uyarÄ±sÄ± eklenmesi iyileÅŸtirme fÄ±rsatÄ± olarak not edildi.

- **Meter Durumu**
  - Fiziksel ABB B23 112-100 meter entegrasyonu **aktif**: RS485/Modbus RTU Ã¼zerinden okuma ve API endpoint'leri Ã§alÄ±ÅŸÄ±r durumda.
  - Sahada doÄŸrulanan ayarlar:
    - Port: `/dev/ttyAMA5`
    - Baudrate: **2400**
    - Parity: EVEN
    - Slave ID: 1
    - Function Code: `0x03` (Holding Registers)
  - API'de `/api/meter/status` ve `/api/meter/reading` endpoint'leri artÄ±k sayaÃ§tan gelen deÄŸerleri dÃ¶ndÃ¼rÃ¼yor (energy_kWh, V, A, W).
  - Not: SayaÃ§ ekranÄ±ndaki hangi sayfa/parametre gÃ¶steriliyorsa (kW/kWh), gerekirse API tarafÄ±nda export/net register'larÄ± ve power factor/frequency gibi alanlar da geniÅŸletilebilir.
  - **Yeni durum (2025-12-12):** Sahada ABB yerine **Acrel T317/ADL400 MID** sayaÃ§ devrede.
    - Ayarlar (cihaz Ã¼zerindeki): Baudrate **9600**, Parity **EVEN**, Slave ID **111**
    - ModÃ¼lerlik: ABB ayarlarÄ± ayrÄ± kalacak ÅŸekilde `METER_TYPE=acrel` ile yeni driver aktif edildi.
    - DoÄŸrulama: `/api/meter/reading` Acrel Ã¼zerinden gerÃ§ek deÄŸer dÃ¶ndÃ¼rÃ¼yor (V/A/kW/kWh/PF/Hz, faz & total alanlarÄ±).

---

## Versiyon GeÃ§miÅŸi

### Version 2.3.1 (2025-12-13 01:05:00)
- Workspace log rotasyonu yapÄ±ldÄ±; eski `api.log.*` dosyalarÄ± temizlendi, aktif loglar sÄ±fÄ±rlandÄ±.
- `python3 scripts/workspace_auto_check.py` raporu tekrar Ã§alÄ±ÅŸtÄ±rÄ±larak env/logs hariÃ§ boyutun 29.13 MB olduÄŸu doÄŸrulandÄ±.
- env/ klasÃ¶rÃ¼ 102 MB (warning) olduÄŸu iÃ§in `master_next.md` iÃ§inde yeni kÃ¼Ã§Ã¼ltme/gÃ¶Ã§ gÃ¶revi aÃ§Ä±ldÄ±.

### Version 2.4.0 (2025-12-13 02:45:00)
- env/ klasÃ¶rÃ¼ 76.7 MB seviyesine indirildi (`__pycache__`/`.pyc` temizliÄŸi, `workspace_auto_check` doÄŸrulamasÄ±).
- Standart uyarÄ±sÄ± veren API modÃ¼lleri modÃ¼ler yapÄ±lara bÃ¶lÃ¼ndÃ¼: `api/cache_backend.py`, `api/logging_setup.py`, `api/event_types.py`, `api/alerting_models.py`, `api/session/events_{logging,lifecycle}.py`, `api/database/schema_mixin.py`, `api/services/health_service.py`.
- EzilmiÅŸ test dosyalarÄ± ayrÄ±ÅŸtÄ±rÄ±ldÄ± (`tests/test_session_model.py`, `tests/test_session_manager_integration.py`, `tests/test_event_detector_integration.py`, `tests/test_command_protocol.py`, `tests/test_protocol_rules.py`).
- `scripts/standards_auto_check.py` tamamen temiz; `scripts/workspace_auto_check.py` raporu env/logs hariÃ§ 29.26 MB, env 76.73 MB.

### Version 2.5.0 (2025-12-13 03:20:00)
- Mobil uygulamalar iÃ§in yeni `/api/mobile/charging/current`, `/api/mobile/charging/sessions` ve `/api/mobile/charging/sessions/{session_id}` uÃ§ noktalarÄ± eklendi.
- Endpointâ€™ler istasyon formundan gelen `price_per_kwh` verisini maliyet hesaplamasÄ±na dahil ediyor; aktif oturum, trend verileri ve alert listeleri tek bir payloadâ€™da dÃ¶ndÃ¼rÃ¼lÃ¼yor.
- Yeni `tests/test_mobile_api.py` paketi ile mobil uÃ§ noktalar iÃ§in Ã¼Ã§ temel senaryo (canlÄ± durum, detay, tarih filtresi) kapsandÄ±.

### Version 2.5.1 (2025-12-13 20:16:00)
- GerÃ§ek EV testi sÄ±rasÄ±nda `/test` sayfasÄ± stabilitesi artÄ±rÄ±ldÄ±: `/api/status` polling 10s yapÄ±ldÄ±; 429/geÃ§ici hatalarda deÄŸerler artÄ±k temizlenmiyor.
- `/test` UIâ€™da 3â€‘faz total power hesaplamasÄ± eklendi: faz V/I Ã¼zerinden total kW tÃ¼retilerek saha (Tesla) ekranÄ±ndaki ~10 kW ile uyumlandÄ±.
- Mobile snapshot UIâ€™da `session.energy_kwh` null durumunda measurements importâ€™a fallback ve total power iÃ§in V/I tÃ¼retimi eklendi.
- Not: Backend tarafÄ±nda total power alanlarÄ±nÄ±n (meter/mobile/station) 3â€‘faz toplamÄ± doÄŸru yansÄ±tmasÄ± iÃ§in `todo/master_next.md` iÃ§ine takip gÃ¶revi eklendi.

### Version 2.5.2 (2025-12-13 20:47:00)
- **Acrel meter total power dÃ¼zeltildi:** `api/meter/acrel.py` iÃ§inde total kW, faz toplamÄ±/V-I tÃ¼retimi ile normalize edildi (saha 3â€‘faz ~10 kW ile uyum).
- **Ghost ACTIVE session Ã¶nleme:** `api/session/events_lifecycle.py` session start/end sÄ±rasÄ±nda DBâ€™de ACTIVE kalan diÄŸer sessionâ€™larÄ± otomatik CANCELLED yapÄ±yor.
- **Session enerji metriÄŸi dÃ¼zeltmesi:** Meter start/end energy varken `total_energy_kwh` artÄ±k meter delta ile set ediliyor (aÅŸÄ±rÄ± bÃ¼yÃ¼k/yanlÄ±ÅŸ enerji metrikleri engellendi).
- DB create_session insertâ€™i `start_energy_kwh` kolonunu metadataâ€™dan dolduracak ÅŸekilde gÃ¼ncellendi.

### Version 2.5.3 (2025-12-13 20:58:00)
- `/api/station/status` `realtime_power_kw` artÄ±k CHARGING durumunda **meter Ã¶lÃ§Ã¼mÃ¼nÃ¼** (varsa) kullanÄ±yor; PWM/Max tek-faz tahmini sadece fallback.

### Version 2.5.4 (2025-12-13 22:11:00)
- Mobile API aktif session iyileÅŸtirmeleri:
  - `/api/mobile/charging/current` iÃ§in negatif `duration_minutes` dÃ¼zeltildi (naive local timestamp â†’ UTC dÃ¶nÃ¼ÅŸÃ¼mÃ¼).
  - Aktif sessionâ€™da `energy_kwh` artÄ±k meter delta ile hesaplanÄ±yor (`import_kwh - start_energy_kwh`) ve `cost.estimated_total` doluyor.
  - `/api/mobile/charging/sessions` ve `/api/mobile/charging/sessions/{session_id}` aktif session iÃ§in live meter Ã¶lÃ§Ã¼mÃ¼yle `duration_minutes/energy_kwh/cost` dolduruyor; power/current/voltage alanlarÄ± null kalmÄ±yor.
- Mobile measurements enerji kaynaÄŸÄ± gÃ¼ncellendi: import iÃ§in `energy_import_kwh` registerâ€™Ä± varsa Ã¶ncelikli.
- Åarj stop sonrasÄ± MAX akÄ±m otomatik reset: `/api/charge/stop` baÅŸarÄ±lÄ± olduktan sonra state IDLE/READYâ€™ye dÃ¼ÅŸtÃ¼ÄŸÃ¼nde akÄ±m `station_info.max_current_amp` (varsayÄ±lan 32A) deÄŸerine geri alÄ±nÄ±r.
- `station_info.max_current_amp` default/standart deÄŸer 32A olacak ÅŸekilde gÃ¼ncellendi (form ve data dosyasÄ±).

### Version 2.5.5 (2025-12-13 23:26:00)
- Ghost ACTIVE session cleanup iyileÅŸtirildi:
  - ESP32 `IDLE` + `CABLE=0` iken ACTIVE kalan session otomatik `CANCELLED` edilir (`/api/sessions/current`, `/api/mobile/charging/current`).
- MAX akÄ±m otomatik reset kapsamÄ± geniÅŸletildi:
  - ESP32 `IDLE` + `CABLE=0` iken `MAX` deÄŸeri, `station_info.max_current_amp` (varsayÄ±lan 32A) olacak ÅŸekilde `/api/status` iÃ§inde otomatik resetlenir.
- `/test` UI dÃ¼zeltmesi:
  - Mobile bar â€œCostâ€ artÄ±k toplam maliyeti gÃ¶sterir (fallback: `energy * per_kwh`).

### Version 2.5.6 (2025-12-14 02:55:00)
- **3â€‘faz total power dÃ¼zeltmeleri:**
  - ABB (Modbus): Faz gÃ¼Ã§leri varsa total gÃ¼Ã§ fazlarÄ±n toplamÄ± ile normalize edildi (`power_kw`, `totals.power_kw`).
  - Acrel: Underâ€‘reportingâ€™i Ã¶nlemek iÃ§in total gÃ¼Ã§ seÃ§imi (PF + V/I tÃ¼retimi) iyileÅŸtirildi.
- **Session enerji tutarlÄ±lÄ±ÄŸÄ±:**
  - Session start/end enerji kaydÄ± mÃ¼mkÃ¼nse `energy_import_kwh` registerâ€™Ä± ile hizalandÄ± (fallback: `energy_kwh`).
- **Log hijyeni:**
  - VarsayÄ±lan log rotation yedek sayÄ±sÄ± 5 â†’ 3 (workspace log boyutu limitine uyum).

### Version 2.5.7 (2025-12-14 03:05:00)
- `/test` sayfasÄ±nda â€œMeter Valuesâ€ detay bloÄŸu daha kompakt hale getirildi (ilk iyileÅŸtirme).

### Version 2.5.8 (2025-12-14 03:12:00)
- `/test` sayfasÄ±nda â€œMeter Valuesâ€ detay bloÄŸu **tek satÄ±r yatay** hale getirildi:
  - `meter-detail-grid`: `flex-wrap: nowrap` + `overflow-x: auto` ile kartlar tek satÄ±rda kalÄ±r (dar ekranda yatay kaydÄ±rma).
  - Kart iÃ§i deÄŸerler tek satÄ±r tutulur (nowrap/ellipsis) â†’ gereksiz yÃ¼kseklik oluÅŸmaz.

### Version 2.5.9 (2025-12-14 03:30:00)
- `/api/station/status` `realtime_power_kw` doÄŸruluÄŸu gÃ¼Ã§lendirildi:
  - Meter gÃ¼cÃ¼ iÃ§in `is_connected()` ÅŸartÄ± kaldÄ±rÄ±ldÄ±; best-effort `connect()` + `read_all()` ile CHARGING anlÄ±k gÃ¼Ã§ daha stabil okunur.
  - Test eklendi: `tests/test_api_main_endpoints.py` iÃ§inde meter Ã¶nceliÄŸi doÄŸrulandÄ±.

### Version 2.5.10 (2025-12-14 03:50:00)
- `/api/status` telemetri aÃ§Ä±klamasÄ± eklendi:
  - `data.telemetry` bloÄŸu RL/LOCK alanlarÄ±nÄ± aÃ§Ä±klar (`relay_feedback`, `lock_engaged`, `note`).
  - CHARGING/PAUSED iken RL/LOCK=0 ise `data.warnings` altÄ±nda uyarÄ± kodlarÄ± eklenir (donanÄ±mda lock/feedback yoksa bu normal olabilir).

### Version 2.5.11 (2025-12-14 04:02:00)
- Acrel enerji register semantiÄŸi iÃ§in debug kolaylÄ±ÄŸÄ± eklendi:
  - `api/meter/acrel.py` iÃ§inde `totals.energy_total_kwh` alias ve `totals.registers` referans bloÄŸu eklendi (saha teyidi iÃ§in).

### Version 2.3.0 (2025-12-12 22:35:00)
- Acrel T317/ADL400 meter desteÄŸi eklendi (`api/meter/acrel.py`), config `METER_TYPE=acrel` geÃ§erli hale getirildi.
- `requirements.txt` iÃ§ine `pymodbus==3.6.7` eklendi.
- `/test` sayfasÄ±ndaki JS parse hatalarÄ± giderildi (tarayÄ±cÄ± uyumluluÄŸu); `/test` endpoint no-cache header ile servis ediliyor, `/favicon.ico` 204 dÃ¶nÃ¼yor.

### Version 2.2.1 (2025-12-12 21:12:00)
- `.gitignore` dosyasÄ±na `docs/acrel/` girdisi eklendi; aÄŸÄ±r Acrel teknik dokÃ¼man arÅŸivi git geÃ§miÅŸinden hariÃ§ tutuluyor.
- Todo ve durum dosyalarÄ± (`master_next`, `master_live`, `master_done`, `project_state`) ile bu dokÃ¼mantasyonda kayÄ±tlar gÃ¼ncellendi.
- `scripts/code_quality_auto_check.py` zincirleme Black uyarÄ±larÄ± iÃ§in `api/meter/acrel.py`, `api/meter/modbus.py` ve `esp32/bridge.py` dosyalarÄ±nda format + zaman damgasÄ± revizyonlarÄ± yapÄ±ldÄ±.

### Version 2.2.0 (2025-12-12 08:55:00)
- Meter iletiÅŸimi sahada aktif edildi (A/B swap + baudrate 2400).
- `meter/read_meter.py` register map gÃ¼ncellendi (ABB B23 holding register'lar) ve okuma stabilize edildi.
- API meter endpoint'leri gerÃ§ek meter deÄŸerleriyle Ã§alÄ±ÅŸÄ±r hale getirildi.

### Version 2.1.0 (2025-12-11 13:45:00)
- GerÃ§ek araÃ§ testi sonucu "meter hariÃ§ her ÅŸey Ã§alÄ±ÅŸÄ±yor" senaryosu dokÃ¼mante edildi.
- AraÃ§ BMS SOC limiti nedeniyle READY durumunda bekleme senaryosu analiz edilerek istasyon tarafÄ±nÄ±n doÄŸru davrandÄ±ÄŸÄ± teyit edildi.
- Meter entegrasyonunun henÃ¼z tamamlanmadÄ±ÄŸÄ±, ancak planlÄ± gÃ¶revler kapsamÄ±nda Faz 4'te ele alÄ±nacaÄŸÄ± netleÅŸtirildi.

### Version 2.0.0 (2025-12-09 22:30:00)
- DokÃ¼mantasyon bÃ¶lÃ¼mlere ayrÄ±ldÄ±
- Ana dosya sadeleÅŸtirildi (~300 satÄ±r)
- DetaylÄ± bilgiler ayrÄ± dosyalara taÅŸÄ±ndÄ±:
  - `docs/api_reference.md` - API referansÄ±
  - `docs/architecture.md` - Sistem mimarisi
  - `docs/deployment.md` - Deployment kÄ±lavuzu
  - `docs/troubleshooting.md` - Sorun giderme

### Version 1.9.0 (2025-12-09 22:00:00)
- Kod ve DokÃ¼mantasyon StandartlarÄ± eklendi
- CODE_DOCUMENTATION_STANDARDS.md dosyasÄ± oluÅŸturuldu
- .cursorrules'a boyut standartlarÄ± eklendi
- Mevcut dosya durumu analizi yapÄ±ldÄ±
- Refactoring Ã¶ncelikleri belirlendi

_(Ã–nceki versiyonlar iÃ§in detaylÄ± bilgiler `docs/architecture.md` dosyasÄ±na bakÄ±nÄ±z)_

---

**Son GÃ¼ncelleme:** 2025-12-18 22:20:00

### Son DeÄŸiÅŸiklikler (2025-12-18)
- OCPP Phaseâ€‘1.3: `TransactionEvent(Ended).stoppedReason` mapping eklendi (Default: EVDisconnected, Local: simulated flag, Remote: inbound `RequestStopTransaction`).
- `--once --poc` kanÄ±t akÄ±ÅŸÄ±na Phaseâ€‘1.3 notlarÄ± ve yeni CLI parametreleri eklendi (`--poc-stop-source`, `--poc-remote-stop-wait-seconds`).
- OCPP Phaseâ€‘1.4: Runbook A/B/C kanÄ±tÄ± alÄ±ndÄ± (RequestStartTransaction â†’ SetChargingProfile â†’ RequestStopTransaction) ve tek `--once` JSON rapor formatÄ±yla doÄŸrulandÄ±.
